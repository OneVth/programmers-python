# 2차원 배열 대각선 인덱스 패턴

## 핵심 공식

| 패턴 | 의미 | 대각선 방향 |
|------|------|-------------|
| `i + j = k` | k번째 대각선 위의 점들 | ↙ (왼쪽 아래 방향) |
| `i - j = k` | k번째 대각선 위의 점들 | ↘ (오른쪽 아래 방향) |

---

## 패턴 1: i + j (왼쪽 위 → 오른쪽 아래 대각선)

```
     j=0  j=1  j=2  j=3
i=0   0    1    2    3     ← i+j 값
i=1   1    2    3    4
i=2   2    3    4    5
i=3   3    4    5    6
```

### 시각화: i + j = k 인 칸들

```
k=0:  [0]  .    .    .      k=2:   .    .   [2]   .
       .   .    .    .             .   [2]   .    .
       .   .    .    .            [2]   .    .    .
       .   .    .    .             .    .    .    .

k=1:   .  [1]   .    .      k=3:   .    .    .   [3]
      [1]  .    .    .             .    .   [3]   .
       .   .    .    .             .   [3]   .    .
       .   .    .    .            [3]   .    .    .
```

### i + j <= k 영역 (왼쪽 위 삼각형)

```
k=2일 때 포함되는 영역:

     j=0  j=1  j=2  j=3
i=0  [0]  [1]  [2]   3     ← i+j: 0,1,2 포함 / 3 제외
i=1  [1]  [2]   3    4     ← i+j: 1,2 포함 / 3,4 제외
i=2  [2]   3    4    5     ← i+j: 2 포함 / 3,4,5 제외
i=3   3    4    5    6     ← 모두 제외 (i+j >= 3)

→ 대각선 기준 왼쪽 위 삼각형 영역
```

---

## 패턴 2: i - j (오른쪽 위 → 왼쪽 아래 대각선)

```
     j=0  j=1  j=2  j=3
i=0   0   -1   -2   -3     ← i-j 값
i=1   1    0   -1   -2
i=2   2    1    0   -1
i=3   3    2    1    0
```

### 시각화: i - j = k 인 칸들

```
k=0 (주대각선):           k=1:
     [0]   .    .    .         .    .    .    .
      .   [0]   .    .        [1]   .    .    .
      .    .   [0]   .         .   [1]   .    .
      .    .    .   [0]        .    .   [1]   .
```

### 활용: 주대각선 기준 위/아래 구분

```python
# 주대각선 위 (i < j)
i - j < 0

# 주대각선 (i == j)
i - j == 0

# 주대각선 아래 (i > j)
i - j > 0
```

---

## 실전 활용 코드

### 1. 특정 대각선 합 구하기

```python
def diagonal_sum(board, k):
    """i + j = k인 대각선의 합"""
    total = 0
    for i in range(len(board)):
        j = k - i
        if 0 <= j < len(board[0]):
            total += board[i][j]
    return total
```

### 2. 대각선 기준 영역 합 구하기

```python
def upper_left_sum(board, k):
    """i + j <= k인 영역의 합 (왼쪽 위 삼각형)"""
    return sum(
        board[i][j]
        for i in range(len(board))
        for j in range(len(board[0]))
        if i + j <= k
    )
```

### 3. 대각선별 그룹화

```python
from collections import defaultdict

def group_by_diagonal(board):
    """i + j 값으로 대각선 그룹화"""
    diagonals = defaultdict(list)
    for i in range(len(board)):
        for j in range(len(board[0])):
            diagonals[i + j].append(board[i][j])
    return diagonals

# 예: [[1,2,3], [4,5,6], [7,8,9]]
# → {0: [1], 1: [2,4], 2: [3,5,7], 3: [6,8], 4: [9]}
```

### 4. 최적화: 불필요한 순회 제거

```python
def upper_left_sum_optimized(board, k):
    """j 범위를 제한하여 불필요한 반복 제거"""
    total = 0
    for i in range(len(board)):
        max_j = min(len(board[0]), k - i + 1)  # i + j <= k → j <= k - i
        if max_j <= 0:
            break  # 더 이상 유효한 j 없음
        for j in range(max_j):
            total += board[i][j]
    return total
```

---

## 대각선 방향 정리

```
┌─────────────────────────────────────────────┐
│  2차원 배열 대각선 인덱스 규칙               │
├─────────────────────────────────────────────┤
│                                             │
│  i + j = 상수  →  ↙ 방향 대각선             │
│                   (0,2)-(1,1)-(2,0)         │
│                                             │
│  i - j = 상수  →  ↘ 방향 대각선             │
│                   (0,0)-(1,1)-(2,2)         │
│                                             │
│  ─────────────────────────────────────────  │
│                                             │
│  i + j <= k  →  왼쪽 위 삼각형 영역         │
│  i + j >= k  →  오른쪽 아래 삼각형 영역     │
│  i - j <= k  →  주대각선 위쪽 영역          │
│  i - j >= k  →  주대각선 아래쪽 영역        │
│                                             │
└─────────────────────────────────────────────┘
```

---

## 관련 문제 유형

| 유형 | 인덱스 조건 | 예시 |
|------|------------|------|
| 대각선 순회 | `i + j = 0, 1, 2, ...` | 지그재그 출력 |
| 삼각형 영역 합 | `i + j <= k` | #181829 |
| 주대각선 합 | `i == j` | 행렬 trace |
| 반대각선 합 | `i + j == n - 1` | 정사각 행렬 |

---

*관련 문제: #181829 이차원 배열 대각선 순회하기*
